const PROVIDERS = {
  "0100": "airtel",
  "0101": "airtel",
  "0102": "airtel",
  "0103": "airtel",
  "0104": "airtel",
  "0105": "airtel",
  "0106": "airtel",
  "0107": "airtel",
  "0108": "airtel",
  "0109": "airtel",
  "0110": "safaricom",
  "0111": "safaricom",
  "0112": "safaricom",
  "0113": "safaricom",
  "0114": "safaricom",
  "0115": "safaricom",
  "0116": "safaricom",
  "0117": "safaricom",
  "0118": "safaricom",
  "0119": "safaricom",
  "0120": "safaricom",
  "0121": "safaricom",
  "0122": "safaricom",
  "0123": "safaricom",
  "0124": "safaricom",
  "0125": "safaricom",
  "0126": "safaricom",
  "0127": "safaricom",
  "0128": "safaricom",
  "0129": "safaricom",
  "020": "telkom",
  "0700": "safaricom",
  "0701": "safaricom",
  "0702": "safaricom",
  "0703": "safaricom",
  "0704": "safaricom",
  "0705": "safaricom",
  "0706": "safaricom",
  "0707": "safaricom",
  "0708": "safaricom",
  "0709": "safaricom",
  "0710": "safaricom",
  "0711": "safaricom",
  "0712": "safaricom",
  "0713": "safaricom",
  "0714": "safaricom",
  "0715": "safaricom",
  "0716": "safaricom",
  "0717": "safaricom",
  "0718": "safaricom",
  "0719": "safaricom",
  "0720": "safaricom",
  "0721": "safaricom",
  "0722": "safaricom",
  "0723": "safaricom",
  "0724": "safaricom",
  "0725": "safaricom",
  "0726": "safaricom",
  "0727": "safaricom",
  "0728": "safaricom",
  "0729": "safaricom",
  "0730": "airtel",
  "0731": "airtel",
  "0732": "airtel",
  "0733": "airtel",
  "0734": "airtel",
  "0735": "airtel",
  "0736": "airtel",
  "0737": "airtel",
  "0738": "airtel",
  "0739": "airtel",
  "0740": "safaricom",
  "0741": "safaricom",
  "0742": "safaricom",
  "0743": "safaricom",
  "0744": "safaricom",
  "0745": "safaricom",
  "0746": "safaricom",
  "0747": "jtl",
  "0748": "safaricom",
  "0749": "safaricom",
  "0750": "airtel",
  "0751": "airtel",
  "0752": "airtel",
  "0753": "airtel",
  "0754": "airtel",
  "0755": "airtel",
  "0756": "airtel",
  "0757": "safaricom",
  "0758": "safaricom",
  "0759": "safaricom",
  "0760": "airtel",
  "0761": "airtel",
  "0762": "airtel",
  "0763": "equitel",
  "0764": "equitel",
  "0765": "equitel",
  "0766": "equitel",
  "0767": "equitel",
  "0768": "safaricom",
  "0769": "safaricom",
  "0770": "telkom",
  "0771": "telkom",
  "0772": "telkom",
  "0773": "telkom",
  "0774": "telkom",
  "0775": "telkom",
  "0776": "telkom",
  "0777": "telkom",
  "0778": "telkom",
  "0779": "telkom",
  "0780": "airtel",
  "0781": "airtel",
  "0782": "airtel",
  "0783": "airtel",
  "0784": "airtel",
  "0785": "airtel",
  "0786": "airtel",
  "0787": "airtel",
  "0788": "airtel",
  "0789": "airtel",
  "0790": "safaricom",
  "0791": "safaricom",
  "0792": "safaricom",
  "0793": "safaricom",
  "0794": "safaricom",
  "0795": "safaricom",
  "0796": "safaricom",
  "0797": "safaricom",
  "0798": "safaricom",
  "0799": "safaricom",
  100: "airtel",
  101: "airtel",
  102: "airtel",
  103: "airtel",
  104: "airtel",
  105: "airtel",
  106: "airtel",
  107: "airtel",
  108: "airtel",
  109: "airtel",
  110: "safaricom",
  111: "safaricom",
  112: "safaricom",
  113: "safaricom",
  114: "safaricom",
  115: "safaricom",
  116: "safaricom",
  117: "safaricom",
  118: "safaricom",
  119: "safaricom",
  120: "safaricom",
  121: "safaricom",
  122: "safaricom",
  123: "safaricom",
  124: "safaricom",
  125: "safaricom",
  126: "safaricom",
  127: "safaricom",
  128: "safaricom",
  129: "safaricom",
  20: "telkom",
  254100: "airtel",
  254101: "airtel",
  254102: "airtel",
  254103: "airtel",
  254104: "airtel",
  254105: "airtel",
  254106: "airtel",
  254107: "airtel",
  254108: "airtel",
  254109: "airtel",
  254110: "safaricom",
  254111: "safaricom",
  254112: "safaricom",
  254113: "safaricom",
  254114: "safaricom",
  254115: "safaricom",
  254116: "safaricom",
  254117: "safaricom",
  254118: "safaricom",
  254119: "safaricom",
  254120: "safaricom",
  254121: "safaricom",
  254122: "safaricom",
  254123: "safaricom",
  254124: "safaricom",
  254125: "safaricom",
  254126: "safaricom",
  254127: "safaricom",
  254128: "safaricom",
  254129: "safaricom",
  25420: "telkom",
  254700: "safaricom",
  254701: "safaricom",
  254702: "safaricom",
  254703: "safaricom",
  254704: "safaricom",
  254705: "safaricom",
  254706: "safaricom",
  254707: "safaricom",
  254708: "safaricom",
  254709: "safaricom",
  254710: "safaricom",
  254711: "safaricom",
  254712: "safaricom",
  254713: "safaricom",
  254714: "safaricom",
  254715: "safaricom",
  254716: "safaricom",
  254717: "safaricom",
  254718: "safaricom",
  254719: "safaricom",
  254720: "safaricom",
  254721: "safaricom",
  254722: "safaricom",
  254723: "safaricom",
  254724: "safaricom",
  254725: "safaricom",
  254726: "safaricom",
  254727: "safaricom",
  254728: "safaricom",
  254729: "safaricom",
  254730: "airtel",
  254731: "airtel",
  254732: "airtel",
  254733: "airtel",
  254734: "airtel",
  254735: "airtel",
  254736: "airtel",
  254737: "airtel",
  254738: "airtel",
  254739: "airtel",
  254740: "safaricom",
  254741: "safaricom",
  254742: "safaricom",
  254743: "safaricom",
  254744: "safaricom",
  254745: "safaricom",
  254746: "safaricom",
  254747: "jtl",
  254748: "safaricom",
  254749: "safaricom",
  254750: "airtel",
  254751: "airtel",
  254752: "airtel",
  254753: "airtel",
  254754: "airtel",
  254755: "airtel",
  254756: "airtel",
  254757: "safaricom",
  254758: "safaricom",
  254759: "safaricom",
  254760: "airtel",
  254761: "airtel",
  254762: "airtel",
  254763: "equitel",
  254764: "equitel",
  254765: "equitel",
  254766: "equitel",
  254767: "equitel",
  254768: "safaricom",
  254769: "safaricom",
  254770: "telkom",
  254771: "telkom",
  254772: "telkom",
  254773: "telkom",
  254774: "telkom",
  254775: "telkom",
  254776: "telkom",
  254777: "telkom",
  254778: "telkom",
  254779: "telkom",
  254780: "airtel",
  254781: "airtel",
  254782: "airtel",
  254783: "airtel",
  254784: "airtel",
  254785: "airtel",
  254786: "airtel",
  254787: "airtel",
  254788: "airtel",
  254789: "airtel",
  254790: "safaricom",
  254791: "safaricom",
  254792: "safaricom",
  254793: "safaricom",
  254794: "safaricom",
  254795: "safaricom",
  254796: "safaricom",
  254797: "safaricom",
  254798: "safaricom",
  254799: "safaricom",
  700: "safaricom",
  701: "safaricom",
  702: "safaricom",
  703: "safaricom",
  704: "safaricom",
  705: "safaricom",
  706: "safaricom",
  707: "safaricom",
  708: "safaricom",
  709: "safaricom",
  710: "safaricom",
  711: "safaricom",
  712: "safaricom",
  713: "safaricom",
  714: "safaricom",
  715: "safaricom",
  716: "safaricom",
  717: "safaricom",
  718: "safaricom",
  719: "safaricom",
  720: "safaricom",
  721: "safaricom",
  722: "safaricom",
  723: "safaricom",
  724: "safaricom",
  725: "safaricom",
  726: "safaricom",
  727: "safaricom",
  728: "safaricom",
  729: "safaricom",
  730: "airtel",
  731: "airtel",
  732: "airtel",
  733: "airtel",
  734: "airtel",
  735: "airtel",
  736: "airtel",
  737: "airtel",
  738: "airtel",
  739: "airtel",
  740: "safaricom",
  741: "safaricom",
  742: "safaricom",
  743: "safaricom",
  744: "safaricom",
  745: "safaricom",
  746: "safaricom",
  747: "jtl",
  748: "safaricom",
  749: "safaricom",
  750: "airtel",
  751: "airtel",
  752: "airtel",
  753: "airtel",
  754: "airtel",
  755: "airtel",
  756: "airtel",
  757: "safaricom",
  758: "safaricom",
  759: "safaricom",
  760: "airtel",
  761: "airtel",
  762: "airtel",
  763: "equitel",
  764: "equitel",
  765: "equitel",
  766: "equitel",
  767: "equitel",
  768: "safaricom",
  769: "safaricom",
  770: "telkom",
  771: "telkom",
  772: "telkom",
  773: "telkom",
  774: "telkom",
  775: "telkom",
  776: "telkom",
  777: "telkom",
  778: "telkom",
  779: "telkom",
  780: "airtel",
  781: "airtel",
  782: "airtel",
  783: "airtel",
  784: "airtel",
  785: "airtel",
  786: "airtel",
  787: "airtel",
  788: "airtel",
  789: "airtel",
  790: "safaricom",
  791: "safaricom",
  792: "safaricom",
  793: "safaricom",
  794: "safaricom",
  795: "safaricom",
  796: "safaricom",
  797: "safaricom",
  798: "safaricom",
  799: "safaricom",
};

export function GetProvider(input) {
  // Step 1: Remove all spaces
  input = input.replace(/\s/g, "");

  // Step 2: Remove special characters from start
  input = input.replace(/^[+\-()_]+/, "");

  // Step 3: Validate numeric
  if (!/^\d+$/.test(input)) {
    return { status: "error", message: "invalid characters in number" };
  }

  const length = input.length;
  let provider = "";
  let matchedPrefix = "";

  if (length === 12) {
    for (const prefix in PROVIDERS) {
      if (prefix.startsWith("254") && input.startsWith(prefix)) {
        provider = PROVIDERS[prefix];
        matchedPrefix = prefix;
        break;
      }
    }
  } else if (length === 10) {
    for (const prefix in PROVIDERS) {
      if (prefix.startsWith("0") && input.startsWith(prefix)) {
        provider = PROVIDERS[prefix];
        matchedPrefix = prefix;
        break;
      }
    }
  } else if (length === 9) {
    for (const prefix in PROVIDERS) {
      if (
        !prefix.startsWith("0") &&
        !prefix.startsWith("254") &&
        input.startsWith(prefix)
      ) {
        provider = PROVIDERS[prefix];
        matchedPrefix = prefix;
        break;
      }
    }
  } else {
    return { status: "error", message: "invalid number length" };
  }

  if (provider) {
    return {
      status: "success",
      provider,
      normalized_prefix: matchedPrefix,
      number: input,
    };
  }

  return { status: "error", message: "unknown provider", number: input };
}
